{"version":3,"sources":["../src/types/types.ts","../src/core/env/envSchema.ts","../src/core/env/parseEnv.ts","../src/core/env/loadEnv.ts","../src/client/createClient.ts","../src/schema/metadata.ts"],"names":["NodeEnv","dotenv"],"mappings":";;;;;;;;;;AAAO,IAAK,OAAA,qBAAAA,QAAAA,KAAL;AACL,EAAAA,SAAA,aAAA,CAAA,GAAc,aAAA;AACd,EAAAA,SAAA,YAAA,CAAA,GAAa,YAAA;AACb,EAAAA,SAAA,MAAA,CAAA,GAAO,MAAA;AAHG,EAAA,OAAAA,QAAAA;AAAA,CAAA,EAAA,OAAA,IAAA,EAAA;;;ACIL,IAAM,SAAA,GAAY,EAAE,MAAA,CAAO;AAAA,EAChC,cAAc,CAAA,CAAE,GAAA,CAAI,EAAE,QAAA,EAAU,mBAAmB,CAAA;AAAA,EACnD,QAAA,EAAU,CAAA,CAAE,IAAA,CAAK,OAAO;AAC1B,CAAC;;;ACHM,SAAS,QAAA,CAAS,QAAiB,MAAA,EAA0C;AAClF,EAAA,MAAM,MAAA,GAAS,SAAA,CAAU,SAAA,CAAU,MAAM,CAAA;AAEzC,EAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,IAAA,MAAM,IAAI,KAAA,CAAM,MAAA,CAAO,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,EACtC;AAEA,EAAA,OAAO,MAAA,CAAO,IAAA;AAChB;AARgB,MAAA,CAAA,QAAA,EAAA,UAAA,CAAA;;;ACGhB,IAAI,SAAA;AACJ,IAAM,cAAA,GAAiB,QAAQ,GAAA,CAAI,QAAA;AAE5B,SAAS,OAAA,GAAe;AAC7B,EAAA,IAAI,SAAA,EAAW;AACb,IAAA,OAAO,SAAA;AAAA,EACT;AAEA,EAAAC,MAAA,CAAO,EAAE,KAAA,EAAO,IAAA,EAAM,CAAA;AAEtB,EAAA,SAAA,GAAY,MAAA,CAAO,MAAA;AAAA,IACjB,QAAA,CAAS,QAAQ,GAAA,EAAK,CAAC,UAAU,CAAA,qBAAA,EAAwB,KAAA,CAAM,OAAO,CAAA,CAAE;AAAA,GAC1E;AAEA,EAAA,OAAO,SAAA;AACT;AAZgB,MAAA,CAAA,OAAA,EAAA,SAAA,CAAA;AAcT,SAAS,iBAAA,GAAoB;AAClC,EAAA,IAAI,cAAA,KAAA,YAAA,mBAAuC;AACzC,IAAA,SAAA,GAAY,MAAA;AAAA,EACd;AACF;AAJgB,MAAA,CAAA,iBAAA,EAAA,mBAAA,CAAA;;;ACnBhB,eAAsB,YAAA,GAAe;AACnC,EAAA,MAAM,EAAE,YAAA,EAAa,GAAI,OAAA,EAAQ;AACjC,EAAA,MAAM,EAAA,GAAK,IAAI,MAAA,CAAO;AAAA,IACpB,gBAAA,EAAkB;AAAA,GACnB,CAAA;AAED,EAAA,IAAI;AACF,IAAA,MAAM,GAAG,OAAA,EAAQ;AAAA,EACnB,SAAS,KAAA,EAAO;AACd,IAAA,OAAA,CAAQ,KAAA,CAAM,yCAAoC,KAAK,CAAA;AACvD,IAAA,MAAM,KAAA;AAAA,EACR;AAEA,EAAA,MAAM,EAAA,GAAK,QAAQ,EAAE,CAAA;AAErB,EAAA,OAAO;AAAA,IACL,EAAA;AAAA,IACA;AAAA,GACF;AACF;AAnBsB,MAAA,CAAA,YAAA,EAAA,cAAA,CAAA;ACHf,IAAM,QAAA,GAAW,QAAQ,UAAA,EAAY;AAAA,EAC1C,EAAA,EAAI,MAAA,CAAO,IAAI,CAAA,CAAE,UAAA,EAAW;AAAA,EAC5B,GAAA,EAAK,IAAA,CAAK,KAAK,CAAA,CAAE,OAAA,EAAQ;AAAA,EACzB,KAAA,EAAO,IAAA,CAAK,OAAO,CAAA,CAAE,OAAA;AACvB,CAAC","file":"index.js","sourcesContent":["export enum NodeEnv {\n  development = 'development',\n  production = 'production',\n  test = 'test'\n}\n","import { z } from 'zod'\n\nimport { NodeEnv } from '@/src/types'\n\nexport const envSchema = z.object({\n  DATABASE_URL: z.url({ protocol: /^postgres(ql)?$/ }),\n  NODE_ENV: z.enum(NodeEnv)\n})\n\nexport type Env = z.infer<typeof envSchema>\n","import { ZodError } from 'zod'\n\nimport { envSchema, type Env } from './envSchema'\n\nexport function parseEnv(config: unknown, format: (error: ZodError) => string): Env {\n  const result = envSchema.safeParse(config)\n\n  if (!result.success) {\n    throw new Error(format(result.error))\n  }\n\n  return result.data\n}\n","import { config as dotenv } from 'dotenv'\n\nimport { NodeEnv } from '@/src/types'\n\nimport { type Env } from './envSchema'\nimport { parseEnv } from './parseEnv'\n\nlet cachedEnv: Env | undefined\nconst initialNodeEnv = process.env.NODE_ENV as NodeEnv\n\nexport function loadEnv(): Env {\n  if (cachedEnv) {\n    return cachedEnv\n  }\n\n  dotenv({ quiet: true })\n\n  cachedEnv = Object.freeze(\n    parseEnv(process.env, (error) => `Invalid environment: ${error.message}`)\n  )\n\n  return cachedEnv\n}\n\nexport function resetCachedConfig() {\n  if (initialNodeEnv !== NodeEnv.production) {\n    cachedEnv = undefined\n  }\n}\n","import { drizzle } from 'drizzle-orm/node-postgres'\nimport { Client } from 'pg'\n\nimport { loadEnv } from '@/src/core'\n\nexport async function createClient() {\n  const { DATABASE_URL } = loadEnv()\n  const pg = new Client({\n    connectionString: DATABASE_URL\n  })\n\n  try {\n    await pg.connect()\n  } catch (error) {\n    console.error('‚ùå Failed to connect to database:', error)\n    throw error\n  }\n\n  const db = drizzle(pg)\n\n  return {\n    db,\n    pg\n  }\n}\n","import { pgTable, serial, text } from 'drizzle-orm/pg-core'\n\nexport const metadata = pgTable('metadata', {\n  id: serial('id').primaryKey(),\n  key: text('key').notNull(),\n  value: text('value').notNull()\n})\n"]}